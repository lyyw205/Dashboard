<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>üìë PPT Ïª®Ìä∏Î°§Îü¨</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="../common/sidebar.css">
</head>
<body>
  <div class="ppt-main">
    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <div class="sidebar">
      <div class="sidebar-head">
        <button id="sidebar-toggle">
          <img class="hamburger-icon" src="../assets/hamburger.png">
        </button>
        <a href="../01main/index.html" class="sidebar-head-logo">
          <img class="sidebar-head-loge-img" src="../assets/logo.png">
        </a>
      </div>
      <ul>
        <li class="list-category">
          <span class="list-category-text">MANAGE</span>
        </li>
        <li class="list">
          <a href="../02applylist/applylist.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/form.png" class="form-icon">
              </span>
              <span class="list-content-text">ÌååÌã∞Ïã†Ï≤≠ÏÑú</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../03reservationlist/reservationlist.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/reservationsheet.png" class="form-icon">
              </span>
              <span class="list-content-text">ÏòàÏïΩÏãúÌä∏</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../05cardlogs/index.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/creditcard.png" class="form-icon">
              </span>
              <span class="list-content-text">Ïû¨Î¨¥Í∏∞Î°ù</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../04calendar/calender.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">Ï∫òÎ¶∞Îçî</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../09party-cards-data/party_cards.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">ÌååÌã∞Ïπ¥Îìú Îç∞Ïù¥ÌÑ∞</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../10accounts/accounts.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">Í≤åÎ¶¥Îùº Í≥ÑÏ†ï</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list-category">
          <span class="list-category-text">GAMES</span>
        </li>
        <li class="list">
          <a href="../07ppt/controller.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/ppt.png" class="form-icon">
              </span>
              <span class="list-content-text">ÏßÑÌñâPPT</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
                <li class="list">
          <a href="/11stickgame/controller.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/stick.png" class="form-icon">
              </span>
              <span class="list-content-text">ÎßâÎåÄÍ≤åÏûÑ</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../06quizppt/index.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/person.png" class="form-icon">
              </span>
              <span class="list-content-text">Ïù∏Î¨ºÍ≤åÏûÑ</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
      </ul>
    </div>
    <div class="slide-controller-wrapper">
      <h2>üìë PPT Ïä¨ÎùºÏù¥Îìú Ïª®Ìä∏Î°§Îü¨</h2>
      <button onclick="startPPT()" class="ppt-start-button"><span class="ppt-start-text">PPT ÏãúÏûëÌïòÍ∏∞</span></button>
      <h3>‚úÖ ÏÑ†ÌÉùÎêú Ïä¨ÎùºÏù¥Îìú</h3>
      <div id="selected-slides"></div>
      <div class="slide-list" id="all-sets"></div>
    </div>
  </div>

  <script>
    let displayWindow = null;
    const selectedSlides = [];
    const slideItemsMap = {};

    function startPPT() {
      if (!selectedSlides.length) return alert("ÏÑ†ÌÉùÎêú Ïä¨ÎùºÏù¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.");
      displayWindow = window.open("display.html", "display", "width=1000,height=700");
      setTimeout(() => {
        displayWindow.postMessage({ type: "slides", slides: selectedSlides }, "*");
      }, 500);
    }

    function makeSlideItem(src, labelText) {
      const li = document.createElement("li");
      li.className = "slide-item";

      const img = document.createElement("img");
      img.src = src;

      const label = document.createElement("div");
      label.className = "slide-label";
      label.textContent = labelText.replace(/\.[^/.]+$/, "");

      li.appendChild(img);
      li.appendChild(label);

      // üß† ÏÑ†ÌÉùÎêú Ïù¥ÎØ∏ÏßÄ ÌÜ†Í∏Ä Í∞ÄÎä•ÌïòÍ≤å
      li.onclick = () => {
        const index = selectedSlides.indexOf(src);
        if (index !== -1) {
          selectedSlides.splice(index, 1);
          li.classList.remove("selected");
          renderSelectedSlides();
        } else {
          selectedSlides.push(src);
          li.classList.add("selected");
          renderSelectedSlides();
        }
      };

      slideItemsMap[src] = li; // Ïä¨ÎùºÏù¥Îìú Ìï≠Î™© Ï∂îÏ†ÅÏö©

      return li;
    }

    function addToSelected(src) {
      if (!selectedSlides.includes(src)) {
        selectedSlides.push(src);
        slideItemsMap[src]?.classList.add("selected"); // ‚úÖ ÏÑ†ÌÉù ÌëúÏãú Ï∂îÍ∞Ä
        renderSelectedSlides();
      }
    }

    function renderSelectedSlides() {
      const container = document.getElementById("selected-slides");
      container.innerHTML = "";
      selectedSlides.forEach((src, index) => {
        const div = document.createElement("div");
        div.className = "slide-thumb";
        div.draggable = true;

        const img = document.createElement("img");
        img.src = src;

        const btn = document.createElement("button");
        btn.textContent = "x";
        btn.className = "remove-btn";
        btn.onclick = (e) => {
          e.stopPropagation();
          selectedSlides.splice(index, 1);

          // ‚úÖ slide-listÏóê ÏûàÎäî Ìï¥Îãπ Ìï≠Î™©Ïùò ÏÑ†ÌÉù ÌëúÏãú Ï†úÍ±∞
          if (slideItemsMap[src]) {
            slideItemsMap[src].classList.remove("selected");
          }

          renderSelectedSlides();
        };

        div.appendChild(img);
        div.appendChild(btn);

        div.ondragstart = (e) => {
          e.dataTransfer.setData("index", index);
        };

        div.ondragover = (e) => e.preventDefault();
        div.ondrop = (e) => {
          const from = e.dataTransfer.getData("index");
          const to = index;
          const moved = selectedSlides.splice(from, 1)[0];
          selectedSlides.splice(to, 0, moved);
          renderSelectedSlides();
        };

        container.appendChild(div);
      });
    }

    fetch("slides.json")
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("all-sets");
        Object.entries(data).forEach(([group, files]) => {
          const title = document.createElement("h3");
          title.textContent = group;
          container.appendChild(title);

          const ul = document.createElement("ul");
          files.forEach(file => {
            const fullPath = `ppt-slides/${group}/${file}`;
            ul.appendChild(makeSlideItem(fullPath, file));
          });
          container.appendChild(ul);
        });
      });
  </script>
  <script>
      const toggleBtn = document.getElementById('sidebar-toggle');
      const sidebar = document.querySelector('.sidebar');

      toggleBtn.addEventListener('click', () => {
        if (window.innerWidth <= 768) {
          sidebar.classList.toggle('open');
        } else {
          sidebar.classList.toggle('collapsed');
        }
      });
  </script>
</body>
</html>
