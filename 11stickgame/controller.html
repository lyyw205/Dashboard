<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🎨 컬러 PPT 컨트롤러</title>
  <link rel="stylesheet" href="stickgame.css">
  <link rel="stylesheet" href="/common/sidebar.css">
</head>
<body>
  <div class="stickgame-wrapper">
    <!-- 사이드바 -->
    <div class="sidebar">
      <div class="sidebar-head">
        <button id="sidebar-toggle">
          <img class="hamburger-icon" src="../assets/hamburger.png">
        </button>
        <a href="../01main/index.html" class="sidebar-head-logo">
          <img class="sidebar-head-loge-img" src="../assets/logo.png">
        </a>
      </div>
      <ul>
        <li class="list-category">
          <span class="list-category-text">MANAGE</span>
        </li>
        <li class="list">
          <a href="../02applylist/applylist.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/form.png" class="form-icon">
              </span>
              <span class="list-content-text">파티신청서</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../03reservationlist/reservationlist.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/reservationsheet.png" class="form-icon">
              </span>
              <span class="list-content-text">예약시트</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../05cardlogs/index.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/creditcard.png" class="form-icon">
              </span>
              <span class="list-content-text">재무기록</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../04calendar/calender.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">캘린더</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../09party-cards-data/party_cards.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">파티카드 데이터</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../10accounts/accounts.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/calendar.png" class="form-icon">
              </span>
              <span class="list-content-text">게릴라 계정</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list-category">
          <span class="list-category-text">GAMES</span>
        </li>
        <li class="list">
          <a href="../07ppt/controller.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/ppt.png" class="form-icon">
              </span>
              <span class="list-content-text">진행PPT</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
                <li class="list">
          <a href="/11stickgame/controller.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/stick.png" class="form-icon">
              </span>
              <span class="list-content-text">막대게임</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
        <li class="list">
          <a href="../06quizppt/index.html" class="list-content">
            <span class="list-content-leftwrap">
              <span class="list-content-icon">
                <img src="../assets/person.png" class="form-icon">
              </span>
              <span class="list-content-text">인물게임</span>
            </span>
            <span class="list-content-arrow">
              <img src="../assets/arrow-right.png" class="arrow-right-icon">
            </span>
          </a>
        </li>
      </ul>
    </div>
    <div class="game-wrapper">
      <h2>🎨 PPT 슬라이드 조합 입력</h2>
      <div id="input-container"></div>
      <button onclick="startPPT()" class="ppt-start-button">PPT 시작하기</button>
    </div>
  </div>
  <script>
    const inputContainer = document.getElementById("input-container");

    // 10개까지 입력 필드 생성
    for (let i = 0; i < 8; i++) {
      const group = document.createElement("div");
      group.className = "set-group";

      group.innerHTML = `
        <input type="color" class="color-picker" value="#ececec" />
        <input type="text" class="color-code" value="#ececec" placeholder="#컬러코드" />
        <input type="text" class="textA-input" placeholder="색상 (ex. #빨강)" />
        <input type="text" class="textB-input" placeholder="키워드 (ex. #궁합)" />
      `;

      // 동기화: 스포이드 선택 → 텍스트 코드 반영
      const colorPicker = group.querySelector(".color-picker");
      const colorCode = group.querySelector(".color-code");

      colorPicker.addEventListener("input", () => {
        colorCode.value = colorPicker.value;
      });

      // 동기화: 텍스트 입력 → 스포이드 색 반영
      colorCode.addEventListener("input", () => {
        if (/^#([0-9A-Fa-f]{6})$/.test(colorCode.value)) {
          colorPicker.value = colorCode.value;
        }
      });

      inputContainer.appendChild(group);
    }

    function startPPT() {
      const colors = [...document.querySelectorAll(".color-code")].map(input => input.value);
      const textsA = [...document.querySelectorAll(".textA-input")].map(input => input.value);
      const textsB = [...document.querySelectorAll(".textB-input")].map(input => input.value);

      const slideSets = [];

      for (let i = 0; i < colors.length; i++) {
        if (textsA[i].trim() && textsB[i].trim()) {
          slideSets.push([
            { bg: colors[i], text: textsA[i] },
            { bg: colors[i], text: textsB[i] }
          ]);
        }
      }

      if (!slideSets.length) {
        alert("유효한 슬라이드 조합이 없습니다.");
        return;
      }

      // 슬라이드 세트 랜덤 섞기
      const shuffled = slideSets
        .map(set => ({ set, sort: Math.random() }))
        .sort((a, b) => a.sort - b.sort)
        .flatMap(item => item.set); // 세트 내 순서는 유지하면서 펼치기

      // 디스플레이 페이지 오픈 및 데이터 전송
      const displayWindow = window.open("display.html", "display", "width=1000,height=700");
      setTimeout(() => {
        displayWindow.postMessage({ type: "colorppt", slides: shuffled }, "*");
      }, 500);
    }
  </script>
  <script src="/common/sidebar.js"></script>
</body>
</html>
